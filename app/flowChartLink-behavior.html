<script>
"use strict";
var FlowChartLinkBehavior = {

	properties: {
		startElement: Object,
		endElement: Object,
		pointsToGhost: {
			type: Boolean,
			value: false
		}
	},

	/** color: html valid colorstring */
	connect: function(color) {
		// find offset positions for both elements
		var offsetStart = {
			x: this.startElement.offsetLeft + this.startElement.offsetWidth / 2,
			y: this.startElement.offsetTop + this.startElement.offsetHeight / 2
		};
		var offsetEnd = {
			x: this.endElement.offsetLeft + this.endElement.offsetWidth / 2,
			y: this.endElement.offsetTop + this.endElement.offsetHeight / 2
		};

		// x,y = top left corner
		// x1,y1 = bottom right corner
		var p = {
			x: offsetStart.x < offsetEnd.x ? offsetStart.x : offsetEnd.x,
			x1: offsetStart.x > offsetEnd.x ? offsetStart.x : offsetEnd.x,
			y: offsetStart.y < offsetEnd.y ? offsetStart.y : offsetEnd.y,
			y1: offsetStart.y > offsetEnd.y ? offsetStart.y : offsetEnd.y
		};
		// straight lines should be visible
		this.setAttribute("width", Math.max(p.x1 - p.x, 2));
		this.setAttribute('height', Math.max(p.y1 - p.y, 2));

		this.setAttribute("style", "position: absolute; left: " + p.x + "px; top: " + p.y + "px; z-index: -1");
		var drawContext = this.getContext('2d');

		// draw line on this canvas, line goes from center to center, -1 z-index hides the unneded parts
		drawContext.strokeStyle = color;
		drawContext.lineWidth = 2;
		drawContext.beginPath();
		drawContext.moveTo(offsetStart.x - p.x, offsetStart.y - p.y);
		drawContext.lineTo(offsetEnd.x - p.x, offsetEnd.y - p.y);
		drawContext.stroke();
	}

};
</script>
